#+TITLE: Git â€” safe workflow (bezpieczna praca)
#+STARTUP: showall

Ten dokument opisuje najprostszy i najbezpieczniejszy workflow Git
do pracy z konfiguracjÄ… systemu (np. /etc/nixos).

* Cel
- nigdy nie straciÄ‡ dziaÅ‚ajÄ…cej konfiguracji
- zawsze wiedzieÄ‡ co i kiedy zostaÅ‚o zmienione
- mieÄ‡ moÅ¼liwoÅ›Ä‡ szybkiego powrotu do stabilnego stanu

* Zasady podstawowe
1. Jedna logiczna zmiana = jeden commit
2. Commitujemy czÄ™sto, nawet maÅ‚e kroki
3. Commit message musi mÃ³wiÄ‡ CO i DLACZEGO
4. Zanim zbudujesz system â€” sprawdÅº status repo
5. Repozytorium traktujemy jak dziennik pokÅ‚adowy

* Minimalny cykl pracy

** 1. SprawdÅº status
#+begin_src bash
git status
#+end_src

- clean â†’ OK, moÅ¼emy dziaÅ‚aÄ‡
- dirty â†’ wiesz, Å¼e sÄ… lokalne zmiany

** 2. Edytuj pliki
- edytuj Å›wiadomie
- najlepiej jeden temat naraz

** 3. SprawdÅº rÃ³Å¼nice
#+begin_src bash
git diff
#+end_src

Zadaj sobie pytania:
- czy rozumiem kaÅ¼dÄ… linijkÄ™?
- czy to jest dokÅ‚adnie to, co chciaÅ‚em zmieniÄ‡?

JeÅ›li nie â†’ popraw zanim pÃ³jdziesz dalej.

** 4. Dodaj zmiany
#+begin_src bash
git add <plik>
#+end_src

Lub Å›wiadomie wszystko:
#+begin_src bash
git add .
#+end_src

** 5. Commit (checkpoint)
#+begin_src bash
git commit -m "krÃ³tki, opisowy komunikat"
#+end_src

Dobre przykÅ‚ady:
- enable wezterm module
- add rollback cheat sheet
- refactor zsh aliases â€“ no behavior change

ZÅ‚e przykÅ‚ady:
- update
- fix
- changes

** 6. Build / test (opcjonalnie)

Dopiero po commicie:
#+begin_src bash
sudo nixos-rebuild switch --flake /etc/nixos#nixos
#+end_src

Dlaczego:
- commit = punkt powrotu
- build moÅ¼e siÄ™ nie udaÄ‡, repo jest bezpieczne

** 7. Push (backup zdalny)
#+begin_src bash
git push
#+end_src

Zasady:
- push przynajmniej raz dziennie
- po wiÄ™kszym checkpointcie â€” od razu

* ZÅ‚ota zasada
JeÅ›li boisz siÄ™ commita â€” to znak, Å¼e powinien byÄ‡ mniejszy,
a nie Å¼e nie powinno go byÄ‡.

* Typowe scenariusze ratunkowe

** CofniÄ™cie siÄ™ do ostatniego commita
#+begin_src bash
git restore .
#+end_src
âš ï¸ Usuwa niezapisane zmiany lokalne.

** Sprawdzenie historii
#+begin_src bash
git log --oneline --decorate --graph
#+end_src

** Eksperyment
- zrÃ³b commit: experiment: X
- testuj
- jeÅ›li nie wyszÅ‚o â†’ git reset / rollback w NixOS

Eksperyment bez commita = brak siatki bezpieczeÅ„stwa.

* Mentalny model
- Git â‰  przeszkoda
- Git = ubezpieczenie
- KaÅ¼dy commit to checkpoint w grze ğŸ®

* Minimum, ktÃ³rego pilnujemy
- git status przed buildem
- commit zanim coÅ› moÅ¼e siÄ™ zepsuÄ‡
- push zanim zamkniesz dzieÅ„

JeÅ›li trzymasz siÄ™ tego pliku â€” trudno zrobiÄ‡ sobie krzywdÄ™.
